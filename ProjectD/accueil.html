<div id="Doom">
	<input type="file" name="ressources" id="inputRessources" />

	<input id="clickMe" type="button" value="clickme" onclick="doFunction();" />

	<script>
		$("#inputRessources").change(function(){
			console.log($("#inputRessources")[0].files[0]);
		});

		function doFunction(){
			lireZip();
			//$( "#Doom" ).load( "game.html" );
		}
				
		zip.workerScriptsPath = "lib/";
		
		/* lecture de l'archive .zip de ressources fournie par l'utilisateur */
		function lireZip()
		{
			let blob = $("#inputRessources")[0].files[0]; // récupération du fichier sélectionné dans le formulaire
			let fichierValide = false;
						
			if ( blob.name.endsWith(".zip") ) // s'il s'agit bien d'une archive .zip
			{		
				zip.createReader(new zip.BlobReader(blob),function(reader)
				{
					reader.getEntries(function(entries)
					{
						if (entries.length) // s'il y a au moins un fichier dans l'archive
						{
							entries.forEach(function(entry) // pour chaque fichier contenu dans l'archive
							{
								console.log(entry.filename);
								
								/* vérification de la présence du fichier beatmap.json */
								if ( !fichierValide && entry.filename.endsWith("beatmap.json") )
									fichierValide = true;
							});
						}

						reader.close(function() // après la lecture du contenu de l'archive
						{
							console.log(fichierValide);
							
							/* redirection vers le jeu si le fichier fourni est valide */
							if ( fichierValide )
								$( "#Doom" ).load( "game.html" );
								
							// TODO Transmettre chemin des ressources vers script.js (fonction de chargement)
						});
					});
				},
				function(error){});
			}
			
			return fichierValide;
		};
		
		/*//- Using a function pointer:
		document.getElementById("clickMe").onclick = doFunction;

		//- Using an anonymous function:
		document.getElementById("clickMe").onclick = function () { $( "#Doom" ).load( "game.html" ); };*/
	</script>
</div>
